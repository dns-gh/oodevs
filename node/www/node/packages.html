[#ftl]
<div class="row">
    <div class="span9">
        <div id="upload_error"></div>
        <div id="packages">
            [#-- auto-generated templates --]
            <script type="text/template" id="package_error_template">
                <div class="alert alert-error"><b>Error</b> {{content}}</div>
            </script>
            <script type="text/template" id="package_template">
                {{#if items.length}}
                <div class="package_header">
                    <h2>Installed Packages</h2>
                    <span class="remove_all">
                        <a class="btn"><i class="icon-trash"></i> Clear </a>
                    </span>
                </div>
                {{/if}}
                <table class="table table-striped">

                    [#assign num_cols = 5]
                    [#macro header more type item]
                    <tr class="package_row${more}">
                        <${item} class="type">${type}s</${item}>
                        <${item}>Package</${item}>
                        <${item}>Date</${item}>
                        <${item}>Checksum</${item}>
                        <${item}></${item}>
                    </tr>
                    [/#macro]

                    [#macro row type]
                    {{#is_first_item items "${type}"}}
                    <thead>
                        [@header '' type 'th' /]
                    </thead>
                    <tbody>
                        {{else}}
                        {{#has_item_type items "${type}"}}
                        {{#is_odd_item_row items "${type}"}}
                        <tr class="hide"><td colspan="${num_cols}"></td></tr>
                        {{/is_odd_item_row}}
                        [@header ' sub_header' type 'td' /]
                        {{/has_item_type}}
                        {{/is_first_item}}

                        {{#for_all_items items "${type}"}}
                        <tr class="package_row">
                            <td class="name">
                                {{name}}
                                {{#equal action "error"}}
                                <span>
                                    <a class="label label-important error" rel="tooltip" title="{{error}}">Error</a>
                                </span>
                                {{/equal}}
                            </td>
                            <td class="name">
                                <span>{{package}}</span>
                                <br/>
                                <span class="label label-info">{{version}}</span>
                            </td>
                            <td>{{date}}</td>
                            <td>0x{{checksum}}</td>
                            <td class="action" data-rel="{{id}}">
                                [#if type == "exercise"]
                                <a class="btn more" data-toggle="button"><i class="icon-th-list"></i> More <span class="caret"></span></a>
                                [/#if]
                                <a class="btn delete"><i class="icon-trash"></i> </a>
                            </td>
                        </tr>
                        [#if type == "exercise"]
                        <tr id="briefing_{{id}}" class="hide">
                            <td colspan="${num_cols}" class="item_briefing">
                                {{#if model.length}}<div><span class="item_label">Model</span> {{model}}</div>{{/if}}
                                {{#if terrain.length}}<div><span class="item_label">Terrain</span> {{terrain}}</div>{{/if}}
                                <div class="briefing_content">{{{briefing}}}</div>
                            </td>
                        </tr>
                        <tr class="hide"><td colspan="${num_cols}"></td></tr>
                        [/#if]
                        {{/for_all_items}}
                        [/#macro]
                        [@row type="model" /]
                        [@row type="terrain" /]
                        [@row type="exercise" /]
                    </tbody>
                </table>
            </script>
        </div>
    </div>
</div>
