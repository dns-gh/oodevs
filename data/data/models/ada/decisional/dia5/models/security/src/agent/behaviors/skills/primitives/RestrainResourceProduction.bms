-- ****************************************************************************
-- To decrease resource node production with a specified quantity of ressource
-- @params: self.params.resourceNode, a masalife ResourceNode object
-- @params self.params.quantity, the quantity to remove from resource nodes production.
-- @returns: "restraining", when production restraining is effective.
-- ****************************************************************************
rootnode 
{
    connections = { skill.links.reach, skill.links.restrainProduction },
    feedbacks   = { "restraining" },

    -- --------------------------------------------------------------------------------
    -- Feedbacks
    -- --------------------------------------------------------------------------------
    done = function( self, params ) -- from reach skill
        self.arrived = true
    end,
    restrainingActionRunning = function( self, params )
        Feedback( self.feedbacks.restraining )
    end,

    -- --------------------------------------------------------------------------------
    -- Init
    -- --------------------------------------------------------------------------------
    create = function( self )
        self.arrived = false
    end,

    -- --------------------------------------------------------------------------------
    -- Feedbacks
    -- --------------------------------------------------------------------------------
    activate = function( self )
        local Activate = Activate

        if self.arrived then
            Activate( skill.links.restrainProduction, 1, { 
              resourceNode = self.params.resourceNode, quantity = self.params.quantity } )
        end
        Activate( skill.links.reach, 1, { destination = self.params.resourceNode } )
        self.arrived = false
    end
}