-- **************************************************************************** 
-- Seal Off
-- ****************************************************************************
rootnode
{
    connections = {skill.links.moveToward, skill.nodes.SealOff },

    -- -------------------------------------------------------------------------------- 
    -- Feeback from moveToward
    -- --------------------------------------------------------------------------------
    done = function( self, params, additionnalParams )
        self.arrived = true
    end,

    -- -------------------------------------------------------------------------------- 
    -- Init
    -- --------------------------------------------------------------------------------
    create = function( self, params )
        self.arrived = false
        if self.params.position ~= NIL then
            self.position = self.params.position
        else
            local objectPosition = integration.computeNearestBorder( meKnowledge:getPosition(), self.params.objective:getLocalisation() )
            self.position = CreateKnowledge( world.Point, objectPosition )
        end
    end,

    -- -------------------------------------------------------------------------------- 
    -- Once arrived on objective, seal it off
    -- --------------------------------------------------------------------------------
    activate = function( self )
        local Activate = Activate

        if self.arrived then
            Activate( skill.nodes.SealOff, 1, { objective = self.params.objective } )
        end
        Activate( skill.links.moveToward, 1, { entities = { self.position } } )
        self.arrived = false
    end
}


-- **************************************************************************** 
-- Seal Off
-- Simple action to seal an element off.
-- ****************************************************************************
node "SealOff"
{
    select = function( self )
        self.params.objective:sealOffIt()
    end
}
