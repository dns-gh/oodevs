<?xml version="1.0" encoding="UTF-8"?>
<task xmlns="http://www.masagroup.net/directia/schemas/bm" name="agent.tasks.Attack" source-version="1.0.0" knowledge-class="agent.tasks.knowledges.Attack">
    <description>For the agent, to move and seize a given objective with agressivity. All enemies encountered will be engaged  (depending on the firing distance between the agent and enemies).  The main goal of the mission is not to destroy enemies but to reach the objective.&#xD;
The objectives of the attack can be a set if terrain locations or  a set of enemies. In the last case, the agent will follow the enemies trying to destroy them.</description>
    <parameters>
        <parameter name="objective">
            <description>The objectives to attack.</description>
            <type>
                <class name="properties.Reachable"/>
            </type>
        </parameter>
    </parameters>
    <goal>
        <description>Reach the objective and engage enemies.</description>
    </goal>
    <let name="enemiesToEngage">
        <value>
            <call method="queries.getEnemiesInRange">
                <parameter name="probabilityToHit">
                    <value>
                        <number>0.5</number>
                    </value>
                </parameter>
            </call>
        </value>
    </let>
    <stages>
        <stage label="moving to the objective(s)" permanent="true">
            <skills>
                <skill name="agent.skills.Engage" priority="0.1">
                    <parameter name="entities">
                        <value>
                            <parameter>enemiesToEngage</parameter>
                        </value>
                    </parameter>
                    <parameter name="positions">
                        <value>
                            <call method="queries.getPositionsToDestroy">
                                <parameter name="elementsToDestroy">
                                    <value>
                                        <parameter>enemiesToEngage</parameter>
                                    </value>
                                </parameter>
                            </call>
                        </value>
                    </parameter>
                </skill>
                <skill name="agent.skills.MoveToward" priority="0.9">
                    <parameter name="entities">
                        <value>
                            <list>
                                <parameter>objective</parameter>
                            </list>
                        </value>
                    </parameter>
                </skill>
            </skills>
        </stage>
    </stages>
</task>