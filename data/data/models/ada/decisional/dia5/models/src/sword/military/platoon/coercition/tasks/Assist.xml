<?xml version="1.0" encoding="UTF-8"?>
<task xmlns="http://www.masagroup.net/directia/schemas/bm" name="sword.military.platoon.coercition.tasks.Assist" source-version="1.0.0" knowledge-class="sword.military.platoon.tasks.knowledges.MoveToward">
	<description>
    Cette mission permet de recueillir une unité alliée;
    On passe en paramètre l'unité à recueillir et des positions permettant d'observer et d'engager les ennemis.</description>
	<parameters>
		<parameter name="objectives">
			<description>Les objectifs : les entités amies à recueillir.</description>
			<type>
				<list>
					<class name="sword.military.knowledge.decisional.Positionable"/>
				</list>
			</type>
		</parameter>
		<parameter name="positions">
			<description>Les postions : postions permettant d'observer l'unité alliée et d'engager les ennemis.</description>
			<type>
				<list>
					<class name="sword.military.knowledge.decisional.Destroying"/>
					<class name="sword.military.knowledge.decisional.Observing"/>
				</list>
			</type>
		</parameter>
	</parameters>
	<goal>
		<description>Se déplacer sur une position afin d'observer l'unité alliée à recueillir et engager les ennemis à côté de l'unité alliée.</description>
	</goal>
	<stages>
		<stage label="Recueillir" permanent="true">
			<description>Rejoindre une position permettant d'observer une unité alliée et d'engager un ennemi.</description>
			<goal>
				<description>Rejoindre une position permettant d'observer une unité alliée et d'engager un ennemi.</description>
			</goal>
			<skills>
				<skill name="sword.military.platoon.skills.primitives.ObserveToward" priority="0.9">
					<parameter name="entities">
						<value>
							<parameter>objectives</parameter>
						</value>
					</parameter>
					<parameter name="positions">
						<value>
							<parameter>positions</parameter>
						</value>
					</parameter>
				</skill>
				<skill name="sword.military.platoon.coercition.skills.Engage" priority="0.1">
					<parameter name="entities">
						<value>
							<call method="sword.military.queries.enemies.getEnemiesInRange">
								<parameter name="probabilityToHit">
									<value>
										<number>0.5</number>
									</value>
								</parameter>
							</call>
						</value>
					</parameter>
					<parameter name="positions">
						<value>
							<parameter>positions</parameter>
						</value>
					</parameter>
				</skill>
			</skills>
		</stage>
	</stages>
</task>