-------------------------------------------------------------------------------
-- ReactToFireArea
-- @author GGE
-- @created 2012-03-06
--
-- This file is part of a MASA library or program.
-- Refer to the included end-user license agreement for restrictions.
--
-- Copyright (c) 2010 MASA Group
------------------------------------------------------------------------------

rootnode
{
    connections = { skill.links.moveToward, skill.nodes.Reports },

    done = function( self ) end,
    
    create = function( self )
        self.isSelfProtecting = false
    end,
    
    activate = function( self )
        local Activate = Activate
        
        if not self.isSelfProtecting then
            self.FireObjects = integration.getCollidingObjectsFromType( "fire" )
            if self.FireObjects and #self.FireObjects > 0 then
                Activate( skill.nodes.Reports, 1, { report = eRC_DecrochageFaceAIncendie } )
                self.positionsSurete = integration.getSafetyPositionsFromFireObjects( self.FireObjects, 500 ) -- On décroche à 500m
                StartActivate( skill.links.moveToward, 1, { entities  = self.positionsSurete } )
                self.isSelfProtecting = true
            end    
        end
    end
}

node "Reports"
{
   create = function( self )
        meKnowledge:RC( self.params.report )
    end
}