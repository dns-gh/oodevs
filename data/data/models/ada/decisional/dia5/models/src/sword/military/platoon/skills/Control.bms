-- **************************************************************************** 
-- Control objectives
-- Utilisation de l'intention MoveToward.
-- **************************************************************************** 
rootnode
{
   connections = { skill.nodes.Control, skill.links.moveToward },

    -- -------------------------------------------------------------------------------- 
    -- Feedback when movement is done
    -- --------------------------------------------------------------------------------
    done = function( self, params, additionnalParams ) -- feedbackfrom MoveToward
        self.movementDone = true
    end,

    -- -------------------------------------------------------------------------------- 
    -- Init
    -- --------------------------------------------------------------------------------
    create = function( self )
        self.movementDone = false
    end,

    -- -------------------------------------------------------------------------------- 
    -- Select the moving entities and angage them
    -- --------------------------------------------------------------------------------
   activate = function( self )
       local Activate = Activate
       if not self.params.dontMove then
             Activate( skill.links.moveToward, 1, { entities  = { self.params.objective } } )
       end
       if self.movementDone or self.params.dontMove then
            Activate( skill.nodes.Control, 1, { entity  = self.params.objective } )
       end
   end
}

-- **************************************************************************** 
-- Simple action of controling an element
-- **************************************************************************** 
node "Control"
{
    select = function( self )
        self.params.entity:controlIt() 
    end
}
