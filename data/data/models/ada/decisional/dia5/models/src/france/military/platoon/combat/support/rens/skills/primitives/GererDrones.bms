rootnode
{
    connections = { skill.links.moveToward, skill.nodes.EmbarquerDrone },
    
    done = function( self ) end,
    
    create = function (self )
        self.pions = sword.military.queries.miscellaneous.getFriends[ "execute" ]()
        self.pionsSources = {}
        meKnowledge.dronesToEmbark = {}
        for _, pion in pairs( self.pions ) do
            pion.source:SetbMiseEnOeuvre_ ( false )
            self.pionsSources[#self.pionsSources + 1] = pion.source
        end
        DEC_Transport_EmbarquerPionsSansDelais( self.pionsSources, false )
    end,
    
    activate = function( self )
        local Activate = Activate
        for pionSource in pairs( meKnowledge.dronesToEmbark ) do
           local pion = CreateKnowledge( sword.military.world.PlatoonAlly, pionSource )
           if pion:isOperational() then
                if meKnowledge:getDistanceTo( pion ) < 100 then
                      Activate( skill.nodes.EmbarquerDrone, 1, { pionDrone = pion } )
                else
                    if meKnowledge:getDistanceTo( pion ) < 2000 then
                        Activate( skill.links.moveToward, 1, { entities  = { pion } } )
                    end
                end
            end
        end
    end,
}

-- Embarquement du Drone
node "EmbarquerDrone"
{
    create = function( self )
        self.params.pionDrone.source:SetbMiseEnOeuvre_( false )
        DEC_Transport_EmbarquerPionSansDelais(self.params.pionDrone.source, false)
    end,
}
