<?xml version="1.0" encoding="UTF-8"?>
<task xmlns="http://www.masagroup.net/directia/schemas/bm" name="sword.military.platoon.coercition.tasks.Attack" source-version="1.0.0" knowledge-class="sword.military.platoon.coercition.tasks.knowledges.Attack">
	<description>Cette mission a pour effet principal d'occuper les objectifs terrains. L'agent décidera cependant d'engager les entités hostile en les détruisant ou les chassant du ou des objectifs. Dans le cas ou le paramètre est une unité (attaquer une unité) l'effet sera équivalent à la mission détruire.
 
    </description>
	<parameters>
		<parameter name="objectives">
			<description>Les objectifs à attaquer.</description>
			<type>
				<list>
					<class name="sword.military.knowledge.decisional.Reachable"/>
				</list>
			</type>
		</parameter>
	</parameters>
	<goal>
		<description>Occuper les objectifs.</description>
	</goal>
	<let name="destroyableEntities">
		<value>
			<call method="sword.military.queries.enemies.getEnemiesInRange">
				<parameter name="probabilityToHit">
					<value>
						<number>0.5</number>
					</value>
				</parameter>
			</call>
		</value>
	</let>
	<stages>
		<stage label="Attaque" permanent="true">
			<description>Mouvement tactique et destruction des ennemis proches des objectifs.</description>
			<goal>
				<description>Occuper les objectifs, engager les ennemis.</description>
			</goal>
			<skills>
				<skill name="sword.military.platoon.coercition.skills.Engage" priority="0.1">
					<parameter name="entities">
						<value>
							<parameter>destroyableEntities</parameter>
						</value>
					</parameter>
					<parameter name="positions">
						<value>
							<call method="sword.military.queries.tactical.getPositionsToDestroy">
								<parameter name="elementsToDestroy">
									<value>
										<parameter>destroyableEntities</parameter>
									</value>
								</parameter>
							</call>
						</value>
					</parameter>
				</skill>
				<skill name="sword.military.platoon.skills.MoveToward" priority="0.9">
					<parameter name="entities">
						<value>
							<parameter>objectives</parameter>
						</value>
					</parameter>
				</skill>
			</skills>
		</stage>
	</stages>
</task>