includedFiles = includedFiles or {}
includedFiles["sources/humus/humus_melee/abc/automates/common/Gestion Inf.bms"] = true

local emptyTable = emptyTable

include "bit.lua"


--[[// *****************************************************************************
]]--[[//
]]--[[// $Created: MIA 04-07-19 $
]]--[[// $Archive: /MVW_v10/Build/Data/Data/Modeles/Sources/Melee/Abc/Automates/Common/Gestion Inf.hal $
]]--[[// $Author: Ggr $
]]--[[// $Modtime: 13/05/05 16:30 $
]]--[[// $Revision: 9 $
]]--[[// $Workfile: Gestion Inf.hal $
]]--[[//
]]--[[// *****************************************************************************
]]
--[[// $$$$ MIA 2004-10-04: les missions sont données dans le comportement:
]]--[[// $$$$ MIA 2004-10-04: BEH_Mission_Automate_AssignerMissionsSE
]]
--[[/// ICI TOUS LES APPUIS PARTICULIERS INF
]]
--[[// *****************************************************************************
]]--[[// BEH_Conduite_Automate_ABC_GererAppuiMortier
]]--[[//
]]--[[// Commentaires: 
]]--[[//
]]--[[// *****************************************************************************
]]node "BEH_Conduite_Automate_ABC_GererAppuiMortier_"
{
    feedbacks = { { { "done_BEH_Conduite_Automate_ABC_GererAppuiMortier_" }, "BEH_Conduite_Automate_ABC_GererAppuiMortier_" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Conduite_Automate_ABC_GererAppuiMortier_, {value} ) end,
    activations =
    {
        { "ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA", { "done_ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA" } },
    },

    create = function( self )
    end,

    activate = function( self )
        local Activate = Activate
        self.selPions = self.selPions or DEC_Automate_PionsSansPC()
        local selAppuis_Mortier = S_Cherche_Automate_Filtre_TypePion( self.selPions, "GroupeInfanterie_Mortier" )
        --[[// --> S'il ya des pions en difficulte en PE, demande de les aider
]]local selPions_PE = S_ObtenirPionsDe( eEtatEchelon_Premier, eEtatDestruction_None )
        local rNbreDemande = 0
        for _,x in pairs( selPions_PE or emptyTable ) do
        local _continue = true
do
                local pion = x
                if( F_Pion_GeteEtatDec( pion ) == eEtatDec_Sauvegarde and rNbreDemande < #( selAppuis_Mortier ) ) then
                    do
                        Activate( self.activations.ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA, 1, { DIA_GetAt( selAppuis_Mortier, rNbreDemande ), } )
                                                rNbreDemande = rNbreDemande + 1
                    end
                end

            end

        end

    end,

--[[// *****************************************************************************
]]--[[// ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA
]]--[[//
]]--[[// Commentaires: 
]]--[[//
]]--[[// *****************************************************************************
]]}

node "ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA"
{
    feedbacks = { { { "done_ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA" }, "ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA, {value} ) end,
    create = function( self )
        self._namedParams = {}
        self._namedParams.pMortier = self.params[1]
    end,

    select = function( self )
                if( ModuleBegins() ) then
            do
                if( self._namedParams.pMortier:GetType() == "GroupeInfanterie_Mortier" ) then
                    self._namedParams.pMortier:SetStateVariable( "VE_AppliquerLesFeux", 1 )
                end

            end
        end

    end,

    deselect = function( self )
                self._namedParams.pMortier:SetStateVariable( "VE_AppliquerLesFeux", 0 )
    end,

}

connections = connections or {}
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_GererAppuiMortier_, "ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA", nodes.ACT_Ordre_Automate_ABC_DonnerAppliqerFeuxA }
