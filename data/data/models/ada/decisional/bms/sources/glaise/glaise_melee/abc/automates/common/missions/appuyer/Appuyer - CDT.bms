includedFiles = includedFiles or {}
includedFiles["sources/glaise/glaise_melee/abc/automates/common/missions/appuyer/Appuyer - CDT.bms"] = true

local emptyTable = emptyTable

--[[// *****************************************************************************
]]--[[//
]]--[[// $Created: MIA 03-10-01 $
]]--[[// $Archive: /MVW_v10/Build/Data/Data/Modeles/Sources/Melee/Abc/Automates/Common/Missions/Appuyer/Appuyer - CDT.hal $
]]--[[// $Author: Ggr $
]]--[[// $Modtime: 22/08/05 16:07 $
]]--[[// $Revision: 23 $
]]--[[// $Workfile: Appuyer - CDT.hal $
]]--[[//
]]--[[// *****************************************************************************
]]
--[[// *****************************************************************************
]]--[[// BEH_Conduite_Automate_ABC_Appuyer
]]--[[//
]]--[[// Commentaires:
]]--[[//
]]--[[// *****************************************************************************
]]node "BEH_Conduite_Automate_ABC_Appuyer"
{
    feedbacks = { { { "done_BEH_Conduite_Automate_ABC_Appuyer" }, "BEH_Conduite_Automate_ABC_Appuyer" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Conduite_Automate_ABC_Appuyer, {value} ) end,
    activations =
    {
        { "BEH_CoordDep_Automate_ABC_AssurerLaCoordinationInterne_", { "done_BEH_CoordDep_Automate_ABC_AssurerLaCoordinationInterne_" } },
        { "BEH_Dispositif_Automate_ABC_GererLesAppuis_", { "done_BEH_Dispositif_Automate_ABC_GererLesAppuis_" } },
        { "BEH_Dispositif_Automate_ABC_GererLeDispositif_", { "done_BEH_Dispositif_Automate_ABC_GererLeDispositif_" } },
        { "BEH_RC_Automate_GererConditionOperationnelle", { "done_BEH_RC_Automate_GererConditionOperationnelle" } },
        { "ACT_Info_Automate_Trace", { "done_ACT_Info_Automate_Trace" } },
        { "ACT_RC_Automate", { "done_ACT_RC_Automate" } },
        { "BEH_CoordDep_Automate_ABC_SeCoordonnerAvecAmi_", { "done_BEH_CoordDep_Automate_ABC_SeCoordonnerAvecAmi_" } },
        { "BEH_Ordre_Automate_Attendre_", { "done_BEH_Ordre_Automate_Attendre_" } },
    },

    create = function( self )
        self._namedParams = {}
        self._namedParams.uniteAAppuyer = self.params[1]
    end,

    activate = function( self )
        local Activate = Activate
        --[[// Init
]]self.bResterAHauteur = self.bResterAHauteur or false
        --[[//---------------------------------------------------------------------
]]--[[// Init 
]]--[[//---------------------------------------------------------------------
]]if( ModuleBegins() ) then
            DEC_Trace( "BEH_Conduite_Automate_ABC_Appuyer : debut" )
        end

        Activate( self.activations.BEH_CoordDep_Automate_ABC_AssurerLaCoordinationInterne_, 1, emptyTable )--[[//-----------------------------------------------------------------------------
]]--[[// Coordination de l'escadron
]]--[[//-----------------------------------------------------------------------------
]]
        Activate( self.activations.BEH_Dispositif_Automate_ABC_GererLesAppuis_, 1, emptyTable )--[[//-----------------------------------------------------------------------------
]]--[[// Gestion appuis et releve et SE
]]--[[//-----------------------------------------------------------------------------
]]
        Activate( self.activations.BEH_Dispositif_Automate_ABC_GererLeDispositif_, 1, { true, } )
        --[[//-----------------------------------------------------------------------------
]]--[[// Condition opérationnelle
]]--[[//-----------------------------------------------------------------------------
]]Activate( self.activations.BEH_RC_Automate_GererConditionOperationnelle, 1, { eEtatEchelon_Premier, } )
        --[[//-----------------------------------------------------------------------------
]]--[[// Gestion appui
]]--[[//-----------------------------------------------------------------------------
]]if( S_Dispositif_Automate_ABC_PionsAmisEnDifficultes( self._namedParams.uniteAAppuyer ) ) then
            do
                Activate( self.activations.ACT_Info_Automate_Trace, 1, { " **** Ami en difficulté ****", } )
                Activate( self.activations.ACT_RC_Automate, 1, { eRC_PasseEnAppui, } )
                self.bResterAHauteur = true
            end
        else
do
                Activate( self.activations.ACT_Info_Automate_Trace, 1, { " ** Ami OK  **", } )
                self.bResterAHauteur = false
            end
--[[//-----------------------------------------------------------------------------
]]--[[// Coordinnation avec amis / passage en appui
]]--[[//-----------------------------------------------------------------------------
]]--[[// Se coordonner si l'unité amie a une mission sinon...attendre sauf si rapFor def pour elle
]]        end

        if( DEC_GetMission( self._namedParams.uniteAAppuyer ) ~= nil ) then
            Activate( self.activations.BEH_CoordDep_Automate_ABC_SeCoordonnerAvecAmi_, 1, { self._namedParams.uniteAAppuyer, self.bResterAHauteur, } )
        else
do
                Activate( self.activations.ACT_Info_Automate_Trace, 1, { "$$$ L'unité amie n'a pas de mission, en attente $$$", } )
                Activate( self.activations.BEH_Ordre_Automate_Attendre_, 1, emptyTable )
            end
        end

    end,

}

connections = connections or {}
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "BEH_CoordDep_Automate_ABC_AssurerLaCoordinationInterne_", nodes.BEH_CoordDep_Automate_ABC_AssurerLaCoordinationInterne_ }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "BEH_Dispositif_Automate_ABC_GererLesAppuis_", nodes.BEH_Dispositif_Automate_ABC_GererLesAppuis_ }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "BEH_Dispositif_Automate_ABC_GererLeDispositif_", nodes.BEH_Dispositif_Automate_ABC_GererLeDispositif_ }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "BEH_RC_Automate_GererConditionOperationnelle", nodes.BEH_RC_Automate_GererConditionOperationnelle }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "ACT_Info_Automate_Trace", nodes.ACT_Info_Automate_Trace }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "ACT_RC_Automate", nodes.ACT_RC_Automate }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "BEH_CoordDep_Automate_ABC_SeCoordonnerAvecAmi_", nodes.BEH_CoordDep_Automate_ABC_SeCoordonnerAvecAmi_ }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_ABC_Appuyer, "BEH_Ordre_Automate_Attendre_", nodes.BEH_Ordre_Automate_Attendre_ }
