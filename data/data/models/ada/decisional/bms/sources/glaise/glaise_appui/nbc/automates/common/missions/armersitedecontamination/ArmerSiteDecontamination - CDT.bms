includedFiles = includedFiles or {}
includedFiles["sources/glaise/glaise_appui/nbc/automates/common/missions/armersitedecontamination/ArmerSiteDecontamination - CDT.bms"] = true

local emptyTable = emptyTable

--[[// *****************************************************************************
]]--[[// BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination
]]--[[// 
]]--[[// Commentaires: 
]]--[[//
]]--[[// *****************************************************************************
]]node "BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination"
{
    feedbacks = { { { "done_BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination" }, "BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination, {value} ) end,
    activations =
    {
        { "BEH_Dispositif_Automate_NBC_FaireSuivreLeSE_", { "done_BEH_Dispositif_Automate_NBC_FaireSuivreLeSE_" } },
        { "BEH_CoordDep_Automate_NBC_AssurerLaCoordinationInterne_", { "done_BEH_CoordDep_Automate_NBC_AssurerLaCoordinationInterne_" } },
        { "BEH_Dispositif_Automate_NBC_GererPionsDetruits_", { "done_BEH_Dispositif_Automate_NBC_GererPionsDetruits_" } },
        { "BEH_Dispositif_Automate_NBC_FaireArmerSite_", { "done_BEH_Dispositif_Automate_NBC_FaireArmerSite_" } },
    },

    create = function( self )
    end,

    activate = function( self )
        local Activate = Activate
        self.mission = self.mission or DEC_GetMission( myself )
        Activate( self.activations.BEH_Dispositif_Automate_NBC_FaireSuivreLeSE_, 1, emptyTable )--[[//-----------------------------------------------------------------------------
]]--[[// Gen
]]--[[//-----------------------------------------------------------------------------
]]--[[// PC y compris
]]
        Activate( self.activations.BEH_CoordDep_Automate_NBC_AssurerLaCoordinationInterne_, 1, emptyTable )--[[// PC y compris
]]
        Activate( self.activations.BEH_Dispositif_Automate_NBC_GererPionsDetruits_, 1, emptyTable )
        --[[//-----------------------------------------------------------------------------
]]--[[// Spé
]]--[[//-----------------------------------------------------------------------------
]]Activate( self.activations.BEH_Dispositif_Automate_NBC_FaireArmerSite_, 1, { self.mission.site_, } )
    end,

--[[// *****************************************************************************
]]--[[// BEH_Dispositif_Automate_NBC_FaireArmerSite_
]]--[[// 
]]--[[// Commentaires: marche pas bien // pas utilisé pour l'instant
]]--[[//
]]--[[// *****************************************************************************
]]}

node "BEH_Dispositif_Automate_NBC_FaireArmerSite_"
{
    feedbacks = { { { "done_BEH_Dispositif_Automate_NBC_FaireArmerSite_" }, "BEH_Dispositif_Automate_NBC_FaireArmerSite_" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Dispositif_Automate_NBC_FaireArmerSite_, {value} ) end,
    activations =
    {
        { "ACT_Info_Trace", { "done_ACT_Info_Trace" } },
        { "BEH_Mission_Automate_NBC_AssignerArmerSiteA", { "done_BEH_Mission_Automate_NBC_AssignerArmerSiteA" } },
    },

    create = function( self )
        self._namedParams = {}
        self._namedParams.site = self.params[1]
    end,

    activate = function( self )
        local Activate = Activate
        self.positionSite = self.positionSite or nil
        --[[//-----------------------------------------------------------------------------
]]--[[// Init
]]--[[//-----------------------------------------------------------------------------
]]if( ModuleBegins() ) then
            self.positionSite = S_Geometrie_BarycentreZone( self._namedParams.site )
        end

        --[[//-----------------------------------------------------------------------------
]]--[[// Gestion erreur
]]--[[//-----------------------------------------------------------------------------
]]if( self.positionSite == nil ) then
            do
                Activate( self.activations.ACT_Info_Trace, 1, { " BEH_Dispositif_Automate_NBC_FaireArmerSite: Localisation invalide", } )
                                do return end

            end
--[[//-----------------------------------------------------------------------------
]]--[[// Essayer d'armer le site avec 3 pions
]]--[[//-----------------------------------------------------------------------------
]]        end

        local listePionsDecontamination = S_Automate_NBC_ObtenirPatrouilleDecOperationnelles()
        for _,pion in pairs( listePionsDecontamination or emptyTable ) do
        local _continue = true
            Activate( self.activations.BEH_Mission_Automate_NBC_AssignerArmerSiteA, 1, { ePhase_CDT, pion, self.positionSite, } )

        end

    end,

}

connections = connections or {}
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination, "BEH_Dispositif_Automate_NBC_FaireSuivreLeSE_", nodes.BEH_Dispositif_Automate_NBC_FaireSuivreLeSE_ }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination, "BEH_CoordDep_Automate_NBC_AssurerLaCoordinationInterne_", nodes.BEH_CoordDep_Automate_NBC_AssurerLaCoordinationInterne_ }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination, "BEH_Dispositif_Automate_NBC_GererPionsDetruits_", nodes.BEH_Dispositif_Automate_NBC_GererPionsDetruits_ }
connections[ #connections + 1 ] = { nodes.BEH_Conduite_Automate_NBC_ArmerUnSiteDeDecontamination, "BEH_Dispositif_Automate_NBC_FaireArmerSite_", nodes.BEH_Dispositif_Automate_NBC_FaireArmerSite_ }
connections[ #connections + 1 ] = { nodes.BEH_Dispositif_Automate_NBC_FaireArmerSite_, "ACT_Info_Trace", nodes.ACT_Info_Trace }
connections[ #connections + 1 ] = { nodes.BEH_Dispositif_Automate_NBC_FaireArmerSite_, "BEH_Mission_Automate_NBC_AssignerArmerSiteA", nodes.BEH_Mission_Automate_NBC_AssignerArmerSiteA }
