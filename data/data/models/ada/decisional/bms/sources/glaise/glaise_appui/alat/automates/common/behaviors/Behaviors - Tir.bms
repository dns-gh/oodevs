includedFiles = includedFiles or {}
includedFiles["sources/glaise/glaise_appui/alat/automates/common/behaviors/Behaviors - Tir.bms"] = true

local emptyTable = emptyTable

--[[// -----------------------------------------------------------------------------
]]--[[// Ce comportement permet de gerer la synchronisation des feux au niveau de
]]--[[// l'automate alat.
]]--[[// -----------------------------------------------------------------------------
]]node "BEH_Automate_ALAT_CoordonnerFeux"
{
    feedbacks = { { { "done_BEH_Automate_ALAT_CoordonnerFeux" }, "BEH_Automate_ALAT_CoordonnerFeux" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Automate_ALAT_CoordonnerFeux, {value} ) end,
    create = function( self )
        self._namedParams = {}
        self._namedParams.listePionsACoordonner = self.params[1]
        self._namedParams.pourcentageEngagement = self.params[2]
    end,

    activate = function( self )
        local Activate = Activate
        local pourcentageEffectif = 0
        local compteur = 0
        if( DIA_IsListEmpty( self._namedParams.listePionsACoordonner ) ) then
            Halt( self )
            do return end
        end

        for _,x in pairs( self._namedParams.listePionsACoordonner or emptyTable ) do
        local _continue = true
do
                local pion = x
                if( F_Pion_GeteniEnCours( pion ) == nil ) then
                    _continue = false
                end

                    if _continue then
                                        compteur = compteur + 1
                end
            end

        end

        pourcentageEffectif = compteur / #( self._namedParams.listePionsACoordonner )
        if( pourcentageEffectif >= self._namedParams.pourcentageEngagement ) then
            do
                for _,x in pairs( self._namedParams.listePionsACoordonner or emptyTable ) do
                local _continue = true
                    do
                        local pion = x
                        pion:SetStateVariable( "VE_Coordination_Tir", 1 )
                    end

                end

            end
        end

    end,

}

