includedFiles = includedFiles or {}
includedFiles["sources/glaise/glaise_appui/artdsa/automates/batterie asa mp/behaviors/Behaviors - Eni.bms"] = true

local emptyTable = emptyTable

--[[//------------------------------------------------------------------------------
]]--[[// Pour chaque ennemi connu, on tente de donner un ordre de tir au pion le plus
]]--[[// proche sur l'agent ennemi le plus proche d'une connaissance amie
]]--[[//------------------------------------------------------------------------------
]]node "BEH_Eni_ASA_HAWK_GererTirsDefendreZone"
{
    feedbacks = { { { "done_BEH_Eni_ASA_HAWK_GererTirsDefendreZone" }, "BEH_Eni_ASA_HAWK_GererTirsDefendreZone" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Eni_ASA_HAWK_GererTirsDefendreZone, {value} ) end,
    activations =
    {
        { "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir", { "done_BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir" } },
    },

    create = function( self )
        self._namedParams = {}
        self._namedParams.zone = self.params[1]
    end,

    activate = function( self )
        local Activate = Activate
        --[[// variables locales
]]local listeSAMP = S_Cherche_Automate_Filtre_TypePionOperationnels( DEC_Automate_PionsSansPC(), "SampHawk" )
        local sListeEnis = S_ConnaissancesEnnemiesVivantesPercuesVolantesPourSgpt( DEC_Automate_PionsAvecPC() )
        local sListeEnisADetruire = {}
        for _,x in pairs( --[[//effacer les piste des unites hawk subordonnées
]]listeSAMP or emptyTable ) do
        local _continue = true
do
                local pionHawk = x
                pionHawk:ClearlisteEnisTirAutorise_()
            end
--[[// Trie des unites : priorite dans cette mission aux unites qui sont 
]]--[[// dangereuses pour les connaissances amies qui sont dans la zone et les
]]--[[// pions de la batterie; Dans l'ASA, on considère qu'une unité est dangereuse
]]--[[// a partir du moment ou elle est reconnue ennemie est qu'elle est volante.
]]
        end

        sListeEnisADetruire = S_Eni_Automate_ASA_HAWK_TrieParDangerositeSurAmisDansZone( sListeEnis, self._namedParams.zone )
        --[[//Affectation des pistes de tir en fonction des distances relatives aux
]]--[[//sections de tir hawk
]]Activate( self.activations.BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir, 1, { sListeEnisADetruire, listeSAMP, } )
    end,

--[[//------------------------------------------------------------------------------
]]--[[// Pour chaque ennemi connu, on tente de donner un ordre de tir au pion le plus
]]--[[// proche. On considere en priorité les ennemis les plus proche du site
]]--[[//------------------------------------------------------------------------------
]]}

node "BEH_Eni_ASA_HAWK_GererTirsDefendreSite"
{
    feedbacks = { { { "done_BEH_Eni_ASA_HAWK_GererTirsDefendreSite" }, "BEH_Eni_ASA_HAWK_GererTirsDefendreSite" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Eni_ASA_HAWK_GererTirsDefendreSite, {value} ) end,
    activations =
    {
        { "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir", { "done_BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir" } },
    },

    create = function( self )
        self._namedParams = {}
        self._namedParams.site = self.params[1]
    end,

    activate = function( self )
        local Activate = Activate
        --[[// variables locales
]]local listeSAMP = S_Cherche_Automate_Filtre_TypePionOperationnels( DEC_Automate_PionsSansPC(), "SampHawk" )
        local sListeEnis = S_ConnaissancesEnnemiesVivantesPercuesVolantesPourSgpt( DEC_Automate_PionsAvecPC() )
        local sListeEnisADetruire = {}
        for _,x in pairs( --[[//effacer les piste des unites hawk subordonnées
]]listeSAMP or emptyTable ) do
        local _continue = true
do
                local pionHawk = x
                pionHawk:ClearlisteEnisTirAutorise_()
            end
--[[// Trie des unites : priorite dans cette mission aux unites qui sont proches
]]--[[// du barycentre de la zone a defendre et qui sont dangereuses pour les pions 
]]--[[// de la batterie;
]]
        end

        sListeEnisADetruire = S_Eni_Automate_ASA_HAWK_TrieParDangerositeSurSite( sListeEnis, self._namedParams.site )
        --[[//Affectation des pistes de tir en fonction des distances relatives aux
]]--[[//sections de tir hawk
]]Activate( self.activations.BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir, 1, { sListeEnisADetruire, listeSAMP, } )
    end,

--[[//------------------------------------------------------------------------------
]]--[[// idem defendre site
]]--[[//------------------------------------------------------------------------------
]]}

node "BEH_Eni_ASA_HAWK_GererTirsSurveiller"
{
    feedbacks = { { { "done_BEH_Eni_ASA_HAWK_GererTirsSurveiller" }, "BEH_Eni_ASA_HAWK_GererTirsSurveiller" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Eni_ASA_HAWK_GererTirsSurveiller, {value} ) end,
    activations =
    {
        { "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir", { "done_BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir" } },
    },

    create = function( self )
        self._namedParams = {}
        self._namedParams.site = self.params[1]
    end,

    activate = function( self )
        local Activate = Activate
        --[[// variables locales
]]local listeSAMP = S_Cherche_Automate_Filtre_TypePionOperationnels( DEC_Automate_PionsSansPC(), "SampHawk" )
        local sListeEnis = S_ConnaissancesEnnemiesVivantesPercuesVolantesPourSgpt( DEC_Automate_PionsAvecPC() )
        local sListeEnisADetruire = {}
        for _,x in pairs( --[[//effacer les piste des unites hawk subordonnées
]]listeSAMP or emptyTable ) do
        local _continue = true
do
                local pionHawk = x
                pionHawk:ClearlisteEnisTirAutorise_()
            end

        end

        sListeEnisADetruire = S_Eni_Automate_ASA_HAWK_TrieParDangerositeSurSite( sListeEnis, self._namedParams.site )
        --[[//Affectation des pistes de tir en fonction des distances relatives aux
]]--[[//sections de tir hawk
]]Activate( self.activations.BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir, 1, { sListeEnisADetruire, listeSAMP, } )
    end,

--[[// -----------------------------------------------------------------------------
]]--[[// affectation des pistes en fonction de la distance des pieces de tir aux 
]]--[[// ennemis
]]--[[// -----------------------------------------------------------------------------
]]}

node "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir"
{
    feedbacks = { { { "done_BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir" }, "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir" } },
    SendFeedback = function( self, value ) Feedback( self.feedbacks.done_BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir, {value} ) end,
    create = function( self )
        self._namedParams = {}
        self._namedParams.sListeEnisADetruire = self.params[1]
        self._namedParams.listeSectionsTir = self.params[2]
    end,

    activate = function( self )
        local Activate = Activate
        for _,x in pairs( --[[//tri par distances des ennemis
]]self._namedParams.listeSectionsTir or emptyTable ) do
        local _continue = true
do
                if( x:GetType() ~= "SampHawk" ) then
                    _continue = false
                end

                    if _continue then
                    local sectionHAWK = x
                    sectionHAWK:SetlisteEnisTirAutorise_( S_Liste_TrierParDistanceAPion( sectionHAWK, self._namedParams.sListeEnisADetruire ) )
                end
            end
--[[// gestion de l'overkill. Deux sections de tir ne doivent pas avoir les memes
]]--[[// pistes à traiter.
]]
        end

        for _,x in pairs( self._namedParams.listeSectionsTir or emptyTable ) do
        local _continue = true
do
                if( x:GetType() ~= "SampHawk" ) then
                    _continue = false
                end

                    if _continue then
                    S_Liste_GererOverKill( x, self._namedParams.listeSectionsTir )
                end
            end

        end

        S_Eni_Automate_ASA_HAWK_AffecterPistes( self._namedParams.listeSectionsTir )
    end,

}

connections = connections or {}
connections[ #connections + 1 ] = { nodes.BEH_Eni_ASA_HAWK_GererTirsDefendreSite, "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir", nodes.BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir }
connections[ #connections + 1 ] = { nodes.BEH_Eni_ASA_HAWK_GererTirsDefendreZone, "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir", nodes.BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir }
connections[ #connections + 1 ] = { nodes.BEH_Eni_ASA_HAWK_GererTirsSurveiller, "BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir", nodes.BEH_Eni_Automate_ASA_HAWK_AffecterPistesASectionsDeTir }
