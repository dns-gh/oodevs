includedFiles = includedFiles or {}
includedFiles["sources/common/automates/Globals.bms"] = true

local emptyTable = emptyTable

include "bit.lua"


--[[//=============================================================================
]]--[[// Variables Globales des automates
]]--[[//=============================================================================
]]--[[// Pour RC de l'automate
]]g_bOrdreAnibas = false

--[[// Desactiver la sauvegarde
]]g_bDesactiveSauvegarde = false

g_RC_Id_ = 0

--[[// Macros
]]include "Common/Macros.bms"

include "Common/Automates/Macros.bms"

include "Common/Automates/Functions.bms"


--[[// Reports
]]include "Common/Moteur/EngineReports.bms"

--[[//include "..\..\Data\Reports.xml";
]]--[[//include "..\..\Data\Missions.xml";
]]--[[//=============================================================================
]]--[[// Fonctions
]]--[[//=============================================================================
]]--[[//-----------------------------------------------------------------------------
]]--[[// Renvoie vrai si au moins un pion de l'automate a subit une contamination NBC
]]--[[//-----------------------------------------------------------------------------
]]--[[//-----------------------------------------------------------------------------
]]--[[// Renvoie le taux de destruction d'un automate // MIA pour ADA
]]--[[// MODELE => Taux destruction = [ Nombre pions NonOp / Nombre pions Total ]
]]--[[//-----------------------------------------------------------------------------
]]--[[// détruit tactiques
]]--[[//-----------------------------------------------------------------------------
]]--[[// Renvoie la capacite operationnelle d'un automate // MIA pour ADA
]]--[[// MODELE => CapaciteOP = [ Nombre pions courants / Nombre pions initiaux ]
]]--[[//-----------------------------------------------------------------------------
]]--[[//-----------------------------------------------------------------------------
]]--[[// Renvoie l'etat opérationnel moyen d'un automate // MIA pour ADA
]]--[[// MODELE => Etat OP = [ 1 - TauxDestruction ] * CapaciteOperationnelle
]]--[[//-----------------------------------------------------------------------------
]]function S_EstContamine( )
    local _returnValue = false
    _returnValue = false
    local listePionsSubordonnes = DEC_Automate_PionsAvecPC()
    for _,x in pairs( listePionsSubordonnes or emptyTable ) do
    local _continue = true
do
            if( DEC_Automate_PionEstContamine( x ) ) then
                do
                    _returnValue = true
                                        do return _returnValue end

                end
            end

        end

    end

    do return _returnValue end
end

function S_Automate_TauxDestruction( listePionsSubordonnes )
    local _returnValue = 0
    if( DIA_IsListEmpty( listePionsSubordonnes ) ) then
        do
            _returnValue = 1
                        do return _returnValue end

        end
    end

    local rNombrePionsNonOp = 0
    for _,x in pairs( listePionsSubordonnes or emptyTable ) do
    local _continue = true
do
            local pion = x
            if( F_Pion_GeteEtatDestruction( pion ) == eEtatDestruction_Tactique or F_Pion_GeteEtatDestruction( pion ) == eEtatDestruction_Total ) then
                                rNombrePionsNonOp = rNombrePionsNonOp + 1
            end

        end

    end

    _returnValue = rNombrePionsNonOp / #( listePionsSubordonnes )
    do return _returnValue end
end

function S_Automate_CapaciteOperationnelle( listePionsSubordonnesInitiaux, listePionsSubordonnesCourants )
    local _returnValue = 0
    if( DIA_IsListEmpty( listePionsSubordonnesInitiaux ) ) then
        do
            _returnValue = 0
                        do return _returnValue end

        end
    end

    _returnValue = #( listePionsSubordonnesCourants ) / #( listePionsSubordonnesInitiaux )
    do return _returnValue end
end

function S_Automate_EtatOperationnel( rCapaciteOperationnelle, rTauxDestruction )
    local _returnValue = 0
    _returnValue = ( 1 - rTauxDestruction ) * rCapaciteOperationnelle
    do return _returnValue end
end

