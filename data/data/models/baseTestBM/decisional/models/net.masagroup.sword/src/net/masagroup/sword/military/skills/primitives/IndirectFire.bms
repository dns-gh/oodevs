-- **************************************************************************** 
-- Destroy elements.
-- self.params.entities: the indirectFireable elements
-- ****************************************************************************
rootnode
{
    connections = { skill.nodes.ApplyFire };

    -- -------------------------------------------------------------------------------- 
    -- Main effect is reached: send feedback when entities are all destroyed
    -- --------------------------------------------------------------------------------
    done = function( self, params, additionnalParams )
        Feedback( self.feedbacks.done )
    end,

    -- -------------------------------------------------------------------------------- 
    -- Execute an indirect fire to obtain an effect corresponding to the munition
    -- --------------------------------------------------------------------------------
    activate = function( self )
        if self.params.entity:canApplyFireOnIt( self.params.munition, self.params.interventionType ) then
            Activate( skill.nodes.ApplyFire, 1, { entity = self.params.entity, munition = self.params.munition, interventionType = self.params.interventionType } )
        else
            Feedback( self.feedbacks.done, { state = "no capacity" } )
        end
    end
}

-- **************************************************************************** 
-- ApplyFire on target 
-- ****************************************************************************
node "ApplyFire"
{
    acquire = { [ skill.resources.indirectFire ] = 1 };

    select = function( self )
        if( self.params.entity:applyFireOnIt( self.params.munition, self.params.interventionType ) ) then
            Feedback( self.feedbacks.done, { state = "finish" } )
        end
    end
}